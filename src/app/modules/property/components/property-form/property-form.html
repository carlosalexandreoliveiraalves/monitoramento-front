<div class="flex flex-col h-full relative">
  
  <div class="flex items-center justify-between mb-6 text-primary">
    <h2 class="text-2xl font-bold flex items-center gap-2">
      <span class="material-symbols-outlined">{{ propertyId ? 'edit' : 'add_circle' }}</span>
      {{ propertyId ? 'Editar' : 'Nova' }} Propriedade
    </h2>
    <button 
      (click)="onCancel()" 
      class="text-gray-400 hover:text-gray-600 transition-colors p-1 rounded-full hover:bg-gray-100">
      <span class="material-symbols-outlined">close</span>
    </button>
  </div>

  <div *ngIf="isLoading" class="absolute inset-0 bg-white/70 z-10 flex items-center justify-center">
    <span class="material-symbols-outlined animate-spin text-3xl text-primary">progress_activity</span>
  </div>

  <form [formGroup]="form" (ngSubmit)="onSubmit()" class="flex flex-col gap-5">
    
    <div class="flex flex-col gap-1">
      <label class="font-semibold text-gray-600 text-sm">Área (Hectares)</label>
      <div class="relative">
        <span class="material-symbols-outlined absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 text-lg">square_foot</span>
        <input 
          type="text" 
          formControlName="areaHa" 
          class="pl-10 p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-300 w-full bg-gray-50 focus:bg-white transition-colors"
          placeholder="Ex: 50.5"
          [ngClass]="{'border-red-300 focus:ring-red-200': form.get('areaHa')?.invalid && form.get('areaHa')?.touched}"
        >
      </div>
      <span *ngIf="form.get('areaHa')?.invalid && form.get('areaHa')?.touched" class="text-red-500 text-xs mt-1">
        Campo obrigatório.
      </span>
    </div>

    <div class="flex flex-col gap-1">
      <label class="font-semibold text-gray-600 text-sm">Endereço / Localização</label>
      <div class="relative">
        <span class="material-symbols-outlined absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 text-lg">pin_drop</span>
        <input 
          type="text" 
          formControlName="address" 
          class="pl-10 p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-300 w-full bg-gray-50 focus:bg-white transition-colors"
          placeholder="Ex: Rodovia BR-277, km 50"
          [ngClass]="{'border-red-300 focus:ring-red-200': form.get('address')?.invalid && form.get('address')?.touched}"
        >
      </div>
      <span *ngIf="form.get('address')?.invalid && form.get('address')?.touched" class="text-red-500 text-xs mt-1">
        Endereço é obrigatório.
      </span>
    </div>

    <div class="flex flex-col gap-1">
      <label class="font-semibold text-gray-600 text-sm">Proprietário Responsável</label>
      <div class="relative">
        <span class="material-symbols-outlined absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 text-lg">person</span>
        <select 
          formControlName="personId" 
          class="pl-10 p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-300 w-full bg-gray-50 focus:bg-white transition-colors appearance-none cursor-pointer"
          [ngClass]="{'border-red-300 focus:ring-red-200': form.get('personId')?.invalid && form.get('personId')?.touched}"
        >
          <option [ngValue]="null" disabled>Selecione um usuário...</option>
          <option *ngFor="let person of peopleList" [value]="person.id">
            {{ person.name }} ({{ person.role }})
          </option>
        </select>
        <span class="material-symbols-outlined absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none">expand_more</span>
      </div>
      <span *ngIf="form.get('personId')?.invalid && form.get('personId')?.touched" class="text-red-500 text-xs mt-1">
        Selecione um proprietário.
      </span>
    </div>

    <div class="flex gap-3 mt-4 pt-4 border-t border-gray-100">
      <button 
        type="button" 
        (click)="onCancel()" 
        class="w-1/3 py-3 rounded-lg border border-gray-300 text-gray-600 hover:bg-gray-50 transition-colors font-medium">
        Cancelar
      </button>
      <button 
        type="submit" 
        [disabled]="form.invalid || isLoading" 
        class="w-2/3 py-3 rounded-lg bg-purple-600 text-white shadow hover:bg-purple-700 hover:shadow-lg disabled:opacity-50 disabled:cursor-not-allowed transition-all active:scale-95 font-medium flex justify-center items-center gap-2">
        <span *ngIf="!isLoading">Salvar</span>
        <span *ngIf="isLoading" class="material-symbols-outlined animate-spin text-sm">progress_activity</span>
      </button>
    </div>

  </form>
</div>